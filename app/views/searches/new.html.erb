<div class="center" style="width:800px">
  <h2>Search <%= @group.name %></h2>
  <%= form_for :search, :url => group_searches_path(@group) do |f| %>
    <%= render :partial => 'fields_to_show' %>
    <fieldset>
      <%= f.label :lings, "Languages" %>
      <%= f.select :lings, @search.ling_options, {}, :multiple => true %>
    </fieldset>
    <fieldset>
      <%= f.label :properties, "Properties" %>
      <%= f.select :properties, @search.property_options, {}, :multiple => true %>
    </fieldset>

    <%- if @search.prop_categories.any? -%>
      <%- @search.prop_categories.each do |category| -%>
        <%- prop_val_label  = "#{category} Value Pairs" -%>
        <fieldset id="<%= prop_val_label.underscorize %>">
          <%= f.label :prop_vals, prop_val_label, 
            :for => "#{prop_val_label.underscorize}_options" %>
          <%= f.select :prop_vals, @search.prop_val_options(category), {}, 
            :multiple => true, 
            :name =>  "search[prop_vals][][#{category.downcase}][]", 
            :id => "#{prop_val_label.underscorize}_options" %>
        </fieldset>
      <%- end -%>
    <%- else -%>
      <fieldset>
        <%= f.label :prop_vals, "Property Values" %>
        <%= f.select :prop_vals, @search.prop_val_options, {}, :multiple => true %>
      </fieldset>
    <%- end -%>

    <%= f.submit "Search" %>
  <% end %>
</div>
