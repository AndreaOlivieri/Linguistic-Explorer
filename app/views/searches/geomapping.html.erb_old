<%
	page_heading "Search"
%>
<div id="titleHeader">
	<h2 class="red_grad"><%= @search.group.ling_name_for_depth(0).pluralize %> in the Selection</h2>
</div>
<div class="padded_left padded_right">
  <%= stylesheet_link_tag "leaflet" %>
  <!--[if lte IE 8]>
      <%= stylesheet_link_tag "leaflet.ie" %>
  <![endif]-->
  <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
  <%= javascript_include_tag 'leaflet', 'leaflet_google' %>
  <div id="results_map" style="height:600px;"></div>
  
</div>
<% content_for :scripts do %>
  <script type="text/javascript">
  var map;
  function startMap(){
    // initialize the map with the whole world
    map = new L.Map('results_map', {center: new L.LatLng(29, 0), zoom: 2});
    // create a layer for the Google tiles
    var gmap_layer = new L.Google('ROADMAP');
    // add the layer to the map
    map.addLayer(gmap_layer);
    // now go and process the data!
    addLegend();
  }

  function addLegend(){
    var legend = L.control({position: 'topright'});

    legend.onAdd = function (map) {
      // create the control container with a particular class name
      this._div = L.DomUtil.create('div', 'map-control'); // create a div with a class "info"
      this.fillDiv();
      return this._div;
    };

    legend.fillDiv = function(rows){
      this._div.innerHTML = '<a id="map-legend-btn" class="btn">Legend</a>';
    };

    legend.addTo(map);
    $('body').on('click', 'map-legend-btn', toggleLegend);
  }

  function toggleLegend(){
    
  }

  // whan all the assets are downloaded, start the map!
  $(window).load(startMap);

  </script>
<% end %>