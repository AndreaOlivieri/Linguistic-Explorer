<div class="apple_pagination">
  <!-- render page links in the view: -->
  <%= will_paginate @search.results %>
</div>
<%- common_results = results_in_common_compare_search(@search.results) -%>
<%- if common_results.any? -%>
    <div class="table spacing expand_width">
      <div class="row">
        <%- value_for_header = common_results.first.child -%>
        <%- result_headers(value_for_header).each do |proc| -%>
            <div class="cell"><%= proc.call value_for_header %></div>
        <%- end -%>
      </div>
      <%- common_results.each do |result| -%>
          <%= render :partial => "searches/compare/result_common", :locals => { :result => result}, :inline => true %>
      <%- end -%>
    </div>
<%- end -%>
<%- diff_results = results_diff_compare_search(@search.results) -%>
<%- if diff_results.any? -%>
    <div class="table spacing expand_width">
      <div class="row">
        <%- value_for_header = diff_results.first.child -%>
        <%- diff_headers = result_headers(value_for_header) -%>
        <div class="cell"><%= diff_headers.first.call value_for_header %></div>
        <%- value_for_header.each do |value| -%>
            <div class="cell"><%= diff_headers.drop(1).first.call value %></div>
        <%- end -%>
      </div>
      <%- diff_results.each do |result| -%>
          <%= render :partial => "searches/compare/result_diff", :locals => { :result => result}, :inline => true %>
      <%- end -%>
    </div>
<%- end -%>
<div class="apple_pagination">
  <!-- render page links in the view: -->
  <%= will_paginate @search.results %>
</div>